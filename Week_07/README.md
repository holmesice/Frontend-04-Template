学习笔记

HTML转DOM树。把parser单独拆到文件中，接受HTML文本作为参数，用FSM（有限作态机）来实现HTML的分析，最后返回DOM树。
从标签构建DOM树的基本技巧的使用栈。
遇到开始标签时创建元素并入栈，遇到结束标签时出栈。
自封闭节点可视为入栈后立即出栈。
任何元素的父元素是它入栈前的栈顶。

CSS的计算。
遇到style标签时，把CSS规则保存起来，调用CSS Parser来分析CSS规则。
创建一个元素后，立即计算CSS。
在计算CSS中，必须知道元素的所有父元素才能判断元素的规则是否匹配。因为我们首先获取的是“当前元素”，所以我们获得和计算父元素匹配的顺序是从内向外。
选择器也要从当前元素向外排列。
一旦选择匹配就应用选择器到元素上，形成computedStyle。
CSS规则根据specificity和后来优先规则覆盖。specificity是四元组，越左边权重越高。一个CSS规则的specificity根据包含的简单选择器相加而成。